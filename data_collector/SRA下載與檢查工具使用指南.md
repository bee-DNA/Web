# SRA ä¸‹è¼‰èˆ‡æª¢æŸ¥å·¥å…·ä½¿ç”¨æŒ‡å—

## ğŸ“š ç›®éŒ„

- [å·¥å…·æ¦‚è¿°](#å·¥å…·æ¦‚è¿°)
- [1. æ‰¹é‡ä¸‹è¼‰å·¥å…·](#1-æ‰¹é‡ä¸‹è¼‰å·¥å…·)
- [2. å®Œæ•´æ€§æª¢æŸ¥å·¥å…·](#2-å®Œæ•´æ€§æª¢æŸ¥å·¥å…·)
- [3. é€²åº¦ç®¡ç†](#3-é€²åº¦ç®¡ç†)
- [4. å¸¸è¦‹å•é¡Œ](#4-å¸¸è¦‹å•é¡Œ)
- [5. æ–‡ä»¶çµæ§‹](#5-æ–‡ä»¶çµæ§‹)

---

## å·¥å…·æ¦‚è¿°

æœ¬å°ˆæ¡ˆåŒ…å«å…©å€‹ä¸»è¦ Python å·¥å…·ï¼š

1. **`batch_fastq_downloader.py`** - æ‰¹é‡ä¸‹è¼‰ SRA æª”æ¡ˆä¸¦è§£å£“ç‚º FASTQ
2. **`check_sra_integrity.py`** - æª¢æŸ¥å·²ä¸‹è¼‰ SRA æª”æ¡ˆçš„å®Œæ•´æ€§

---

## 1. æ‰¹é‡ä¸‹è¼‰å·¥å…·

### ğŸ“ æª”æ¡ˆè·¯å¾‘
```
D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\batch_fastq_downloader.py
```

### ğŸ¯ åŠŸèƒ½ç‰¹é»

- âœ… **ä¸¦è¡Œä¸‹è¼‰**: æ”¯æ´åŒæ™‚ä¸‹è¼‰ 10 å€‹æ¨£æœ¬ (`MAX_WORKERS=10`)
- âœ… **è‡ªå‹•é‡è©¦**: å¤±æ•—çš„ä»»å‹™æœƒè‡ªå‹•è¨˜éŒ„ï¼Œå¯é‡æ–°åŸ·è¡Œ
- âœ… **é€²åº¦è¿½è¹¤**: å¯¦æ™‚é¡¯ç¤ºä¸‹è¼‰é€²åº¦å’Œé ä¼°å‰©é¤˜æ™‚é–“
- âœ… **æ–·é»çºŒå‚³**: æ”¯æ´ä¸­æ–·å¾Œç¹¼çºŒä¸‹è¼‰
- âœ… **å››æ­¥é©Ÿæµç¨‹**:
  1. `prefetch` - ä¸‹è¼‰ SRA æª”æ¡ˆåˆ° D æ§½
  2. `fasterq-dump` - è§£å£“ç‚º FASTQ æª”æ¡ˆåˆ° E æ§½
  3. å‚™ä»½ SRA åˆ° E:\sra_files
  4. æ¸…ç† D æ§½è‡¨æ™‚æª”æ¡ˆ

### ğŸ“‹ ä½¿ç”¨æ–¹æ³•

#### åŸºæœ¬ç”¨æ³•

```powershell
# é€²å…¥å·¥ä½œç›®éŒ„
cd "D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector"

# åŸ·è¡Œä¸‹è¼‰ç¨‹å¼
python batch_fastq_downloader.py
```

#### é€²éšè¨­å®š

**ä¿®æ”¹ä¸¦è¡Œæ•¸é‡**:
```python
# ç·¨è¼¯ batch_fastq_downloader.py ç¬¬ 253 è¡Œ
MAX_WORKERS = 10  # å¯æ”¹ç‚º 5ã€15ã€20 ç­‰
```

**ä¿®æ”¹è¶…æ™‚è¨­å®š**:
```python
# prefetch è¶…æ™‚ (ç¬¬ 97 è¡Œ)
timeout=7200  # 120åˆ†é˜ï¼Œå¯æ”¹ç‚º 3600 (60åˆ†é˜) æˆ– 10800 (180åˆ†é˜)

# fasterq-dump è¶…æ™‚ (ç¬¬ 123 è¡Œ)
timeout=9000  # 150åˆ†é˜ï¼Œå¯æ”¹ç‚º 7200 (120åˆ†é˜) æˆ– 12000 (200åˆ†é˜)
```

### ğŸ“Š è¼¸å‡ºè³‡è¨Š

åŸ·è¡Œæ™‚æœƒé¡¯ç¤ºï¼š

```
============================================================
ğŸš€ FASTQ æ‰¹é‡ä¸‹è¼‰å™¨
============================================================
  ç¸½ä»»å‹™: 606
  å·²å®Œæˆ: 141 (23.3%)
  å¤±æ•—: 24
  å‰©é¤˜: 465
  ä¸¦è¡Œæ•¸: 10
  è¼¸å‡º: E:\fastq_data
============================================================

[109/606] é€²åº¦: 18.0% | â±ï¸  é ä¼°å‰©é¤˜: 45å°æ™‚23åˆ†é˜15ç§’

============================================================
ğŸ“¥ è™•ç†: SRR10810029
============================================================
  æ­¥é©Ÿ 1/4: prefetch SRR10810029...
  åŸ·è¡Œä¸­... 124ç§’
  âœ… å®Œæˆ (124.3ç§’)
  æ­¥é©Ÿ 2/4: fasterq-dump SRR10810029...
  åŸ·è¡Œä¸­... 3456ç§’
  âœ… å®Œæˆ (3456.7ç§’)
  æ­¥é©Ÿ 3/4: å‚™ä»½ SRA åˆ° E:\sra_files...
  âœ… å®Œæˆ (12.1ç§’)
  æ­¥é©Ÿ 4/4: æ¸…ç† OneDrive è‡¨æ™‚æª”æ¡ˆ...
  âœ… å®Œæˆ (1.2ç§’)
  â±ï¸  ç¸½æ™‚é–“: 3594.3 ç§’
```

### ğŸ“‚ ç›®éŒ„çµæ§‹

```
D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\
â”œâ”€â”€ batch_fastq_downloader.py          # ä¸»ç¨‹å¼
â”œâ”€â”€ runs.txt                            # æ¨£æœ¬åˆ—è¡¨ (606 å€‹ SRR ID)
â”œâ”€â”€ download_progress.json              # é€²åº¦è¿½è¹¤æª”æ¡ˆ
â”œâ”€â”€ sratoolkit.3.2.1-win64\             # SRA Toolkit å·¥å…·
â”‚   â””â”€â”€ bin\
â”‚       â”œâ”€â”€ prefetch.exe
â”‚       â”œâ”€â”€ fasterq-dump.exe
â”‚       â””â”€â”€ vdb-validate.exe
â”œâ”€â”€ SRR*******\                         # è‡¨æ™‚ SRA ä¸‹è¼‰ç›®éŒ„
â”‚   â””â”€â”€ SRR*******.sra
â””â”€â”€ ...

E:\fastq_data\                          # FASTQ è¼¸å‡ºç›®éŒ„
â”œâ”€â”€ SRR10810025_1.fastq
â”œâ”€â”€ SRR10810025_2.fastq
â”œâ”€â”€ SRR10810029_1.fastq
â”œâ”€â”€ SRR10810029_2.fastq
â””â”€â”€ ...

E:\sra_files\                           # SRA å‚™ä»½ç›®éŒ„
â”œâ”€â”€ SRR10810025.sra
â”œâ”€â”€ SRR10810029.sra
â””â”€â”€ ...
```

### ğŸ”§ æš«åœèˆ‡ç¹¼çºŒ

**æš«åœä¸‹è¼‰**:
```powershell
# æ–¹æ³•1: æŒ‰ Ctrl+C (æ¨è–¦)
# ç¨‹å¼æœƒå®‰å…¨åœæ­¢ä¸¦é¡¯ç¤º:
#   âš ï¸  æ”¶åˆ°ä¸­æ–·ä¿¡è™Ÿ,æ­£åœ¨å®‰å…¨åœæ­¢...
#   â¸ï¸  ç­‰å¾…ç•¶å‰ä»»å‹™å®Œæˆå¾Œé€€å‡º...
#   ğŸ’¾ é€²åº¦å·²ä¿å­˜åˆ° download_progress.json
#   ğŸ”„ ä¸‹æ¬¡åŸ·è¡Œå°‡å¾æ–·é»ç¹¼çºŒ

# æ–¹æ³•2: é—œé–‰çµ‚ç«¯æ©Ÿè¦–çª—
# é€²åº¦æœƒè‡ªå‹•ä¿å­˜
```

**æš«åœè¡Œç‚ºèªªæ˜**:
- â±ï¸ æ­£åœ¨åŸ·è¡Œçš„ 10 å€‹ä¸¦è¡Œä»»å‹™æœƒå®Œæˆç•¶å‰æ­¥é©Ÿ
- ğŸ’¾ å·²å®Œæˆçš„ä»»å‹™è‡ªå‹•ä¿å­˜åˆ° `download_progress.json`
- ğŸš« æ–°çš„ä»»å‹™ä¸æœƒå•Ÿå‹•
- â¸ï¸ é€šå¸¸åœ¨ 1-3 åˆ†é˜å…§å®Œå…¨åœæ­¢ (å–æ±ºæ–¼ç•¶å‰ä»»å‹™é€²åº¦)

**ç¹¼çºŒä¸‹è¼‰**:
```powershell
cd "D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector"
python batch_fastq_downloader.py
# ç¨‹å¼æœƒè‡ªå‹•è·³éå·²å®Œæˆçš„æ¨£æœ¬,å¾å‰©é¤˜æ¨£æœ¬ç¹¼çºŒä¸‹è¼‰
```

### âš™ï¸ é—œéµåƒæ•¸èªªæ˜

| åƒæ•¸ | ä½ç½® | é è¨­å€¼ | èªªæ˜ |
|------|------|--------|------|
| `MAX_WORKERS` | ç¬¬ 253 è¡Œ | 10 | ä¸¦è¡Œä¸‹è¼‰æ•¸é‡ |
| `prefetch timeout` | ç¬¬ 97 è¡Œ | 7200ç§’ (120åˆ†é˜) | prefetch è¶…æ™‚æ™‚é–“ |
| `fasterq-dump timeout` | ç¬¬ 123 è¡Œ | 9000ç§’ (150åˆ†é˜) | è§£å£“è¶…æ™‚æ™‚é–“ |
| `output_dir` | ç¬¬ 260 è¡Œ | `E:/fastq_data` | FASTQ è¼¸å‡ºç›®éŒ„ |
| `sra_backup_dir` | ç¬¬ 142 è¡Œ | `E:/sra_files` | SRA å‚™ä»½ç›®éŒ„ |

---

## 2. å®Œæ•´æ€§æª¢æŸ¥å·¥å…·

### ğŸ“ æª”æ¡ˆè·¯å¾‘
```
D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\check_sra_integrity.py
```

### ğŸ¯ åŠŸèƒ½ç‰¹é»

- âœ… **å¿«é€Ÿæª¢æŸ¥æ¨¡å¼**: åªæª¢æŸ¥æª”æ¡ˆå¤§å° (ç§’ç´šå®Œæˆ)
- âœ… **å®Œæ•´é©—è­‰æ¨¡å¼**: ä½¿ç”¨ `vdb-validate` æª¢æŸ¥å…§éƒ¨çµæ§‹ (åˆ†é˜ç´šå®Œæˆ)
- âœ… **è©³ç´°å ±å‘Š**: ç”Ÿæˆ JSON æ ¼å¼çš„æª¢æŸ¥å ±å‘Š
- âœ… **å•é¡Œåµæ¸¬**: è‡ªå‹•è­˜åˆ¥æå£æˆ–å¯ç–‘çš„æª”æ¡ˆ

### ğŸ“‹ ä½¿ç”¨æ–¹æ³•

#### å¿«é€Ÿæª¢æŸ¥ (æ¨è–¦å…ˆç”¨)

```powershell
cd "D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector"
python check_sra_integrity.py
```

**é è¨­åŸ·è¡Œå®Œæ•´æª¢æŸ¥**ï¼Œå¦‚éœ€å¿«é€Ÿæª¢æŸ¥ï¼Œä¿®æ”¹æœ€å¾Œä¸€è¡Œï¼š

```python
# ç·¨è¼¯ check_sra_integrity.py æœ€å¾Œä¸€è¡Œ
if __name__ == "__main__":
    quick_check_all_sra_files()  # å¿«é€Ÿæª¢æŸ¥
    # check_all_sra_files()      # å®Œæ•´æª¢æŸ¥
```

#### å®Œæ•´é©—è­‰

```python
# ç·¨è¼¯ check_sra_integrity.py æœ€å¾Œä¸€è¡Œ
if __name__ == "__main__":
    check_all_sra_files()  # å®Œæ•´æª¢æŸ¥
```

### ğŸ“Š è¼¸å‡ºç¯„ä¾‹

#### å¿«é€Ÿæª¢æŸ¥è¼¸å‡º

```
================================================================================
âš¡ SRA æª”æ¡ˆå¿«é€Ÿæª¢æŸ¥ (æª”æ¡ˆå¤§å°æª¢æŸ¥)
================================================================================
ğŸ“ æƒæç›®éŒ„: D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector

ğŸ“Š æ‰¾åˆ° 14 å€‹ SRA æª”æ¡ˆ

[1/14] SRR10810025: 3698.8 MB - âœ… æ­£å¸¸
[2/14] SRR10810029: 4717.7 MB - âœ… æ­£å¸¸
[3/14] SRR12180939: 35.1 MB - âœ… æ­£å¸¸
...

================================================================================
ğŸ“Š å¿«é€Ÿæª¢æŸ¥æ‘˜è¦
================================================================================
  ç¸½æª”æ¡ˆæ•¸: 14
  âœ… æ­£å¸¸: 14 (100.0%)
  âš ï¸  å¯ç–‘: 0 (0.0%)
  ğŸ’¾ ç¸½å¤§å°: 43223.5 MB (42.21 GB)
================================================================================
```

#### å®Œæ•´é©—è­‰è¼¸å‡º

```
================================================================================
ğŸ” SRA æª”æ¡ˆå®Œæ•´æ€§æª¢æŸ¥
================================================================================
ğŸ“ æƒæç›®éŒ„: D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector
ğŸ› ï¸  SRA Toolkit: D:\OneDrive\...\sratoolkit.3.2.1-win64\bin
================================================================================

ğŸ“Š æ‰¾åˆ° 14 å€‹ SRA æª”æ¡ˆ

[1/14] æª¢æŸ¥: SRR10810025
  ğŸ“ æª”æ¡ˆ: SRR10810025.sra
  ğŸ’¾ å¤§å°: 3698.8 MB
  ğŸ” å¿«é€Ÿæª¢æŸ¥... è³‡è¨Šå¯ç”¨
  âœ“ å®Œæ•´æ€§é©—è­‰... âœ… å®Œæ•´

[3/14] æª¢æŸ¥: SRR12180939
  ğŸ“ æª”æ¡ˆ: SRR12180939.sra
  ğŸ’¾ å¤§å°: 35.1 MB
  ğŸ” å¿«é€Ÿæª¢æŸ¥... ç„¡æ³•ç²å–è³‡è¨Š
  âœ“ å®Œæ•´æ€§é©—è­‰... âŒ zombie file detected

================================================================================
ğŸ“Š æª¢æŸ¥å®Œæˆæ‘˜è¦
================================================================================
  ç¸½æª”æ¡ˆæ•¸: 14
  âœ… å®Œæ•´: 11 (78.6%)
  âŒ æå£: 3 (21.4%)
  âš ï¸  æœªçŸ¥: 0 (0.0%)
  ğŸ’¾ ç¸½å¤§å°: 43223.5 MB (42.21 GB)
  ğŸ“„ å ±å‘Š: D:\...\sra_integrity_report.json
================================================================================

âŒ æå£çš„æª”æ¡ˆåˆ—è¡¨:
  - SRR12180939: zombie file detected
  - SRR12181006: zombie file detected
  - SRR12181036: zombie file detected
```

### ğŸ“„ æª¢æŸ¥å ±å‘Š

å®Œæ•´æª¢æŸ¥æœƒç”Ÿæˆå ±å‘Šæª”æ¡ˆï¼š
```
D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\sra_integrity_report.json
```

**å ±å‘Šæ ¼å¼**:
```json
{
  "valid": [
    {
      "sample_id": "SRR10810025",
      "file": "D:\\OneDrive\\...\\SRR10810025\\SRR10810025.sra",
      "size_mb": 3698.8,
      "info": "è³‡è¨Šå¯ç”¨"
    }
  ],
  "invalid": [
    {
      "sample_id": "SRR12180939",
      "file": "D:\\OneDrive\\...\\SRR12180939\\SRR12180939.sra",
      "size_mb": 35.1,
      "error": "zombie file detected..."
    }
  ],
  "unknown": [],
  "total_size_mb": 43223.5,
  "check_time": "2025-10-07T10:54:38.123456"
}
```

### ğŸ” æª¢æŸ¥æ¨¡å¼æ¯”è¼ƒ

| æ¨¡å¼ | é€Ÿåº¦ | æº–ç¢ºåº¦ | é©ç”¨å ´æ™¯ |
|------|------|--------|----------|
| **å¿«é€Ÿæª¢æŸ¥** | âš¡ ç§’ç´š | åŸºæœ¬ | å¿«é€Ÿæƒæï¼Œæ‰¾å‡ºæ˜é¡¯ç•°å¸¸çš„æª”æ¡ˆ |
| **å®Œæ•´é©—è­‰** | ğŸŒ åˆ†é˜ç´š | é«˜ | ç¢ºèªæª”æ¡ˆå…§éƒ¨çµæ§‹å®Œæ•´æ€§ |

---

## 3. é€²åº¦ç®¡ç†

### ğŸ“„ é€²åº¦è¿½è¹¤æª”æ¡ˆ

**æª”æ¡ˆè·¯å¾‘**:
```
D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\download_progress.json
```

**æª”æ¡ˆçµæ§‹**:
```json
{
  "completed": [
    "SRR16972395",
    "SRR16972409",
    "SRR10810025"
  ],
  "failed": [
    {
      "run_id": "SRR7986801",
      "step": "prefetch",
      "error": "Timeout after 7200s",
      "time": "2025-10-06T16:36:33.511156"
    }
  ],
  "total_size_mb": 1507474.5919837952,
  "timestamp": "2025-10-02 01:28:38",
  "last_update": "2025-10-06T17:03:07.082627"
}
```

### ğŸ”„ æ‰‹å‹•ç·¨è¼¯é€²åº¦

**é‡æ–°ä¸‹è¼‰ç‰¹å®šæ¨£æœ¬**:

1. æ‰“é–‹ `download_progress.json`
2. å¾ `completed` é™£åˆ—ä¸­ç§»é™¤æ¨£æœ¬ ID
3. åˆªé™¤å°æ‡‰çš„ SRA ç›®éŒ„
4. é‡æ–°åŸ·è¡Œä¸‹è¼‰ç¨‹å¼

```powershell
# ç¯„ä¾‹ï¼šé‡æ–°ä¸‹è¼‰ SRR12180939
# 1. åˆªé™¤ç›®éŒ„
Remove-Item -Recurse -Force "D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\SRR12180939"

# 2. ç·¨è¼¯ download_progress.jsonï¼Œç§»é™¤ "SRR12180939" å¾ completed é™£åˆ—

# 3. é‡æ–°åŸ·è¡Œ
python batch_fastq_downloader.py
```

### ğŸ“Š æŸ¥çœ‹çµ±è¨ˆ

```powershell
cd "D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector"

# ä½¿ç”¨ Python å¿«é€Ÿçµ±è¨ˆ
python -c "
import json
with open('download_progress.json', 'r', encoding='utf-8') as f:
    data = json.load(f)
completed = len(data.get('completed', []))
failed = len(data.get('failed', []))
total = 606
print(f'å·²å®Œæˆ: {completed}/{total} ({completed/total*100:.1f}%)')
print(f'å¤±æ•—: {failed}')
print(f'å‰©é¤˜: {total - completed}')
print(f'ç¸½å¤§å°: {data.get(\"total_size_mb\", 0)/1024:.1f} GB')
"
```

---

## 4. å¸¸è¦‹å•é¡Œ

### â“ Q1: ä¸‹è¼‰é€Ÿåº¦å¤ªæ…¢æ€éº¼è¾¦ï¼Ÿ

**A**: 
- æª¢æŸ¥ç¶²è·¯é€£ç·šé€Ÿåº¦
- é™ä½ `MAX_WORKERS` é¿å…é »å¯¬åˆ†æ•£
- è€ƒæ…®ä½¿ç”¨ Aspera åŠ é€Ÿï¼ˆéœ€é¡å¤–é…ç½®ï¼‰
- é¿é–‹ NCBI ä¼ºæœå™¨é«˜å³°æ™‚æ®µ

### â“ Q2: é‡åˆ° "disk-limit exceeded" éŒ¯èª¤

**A**:
```powershell
# æª¢æŸ¥ç£ç¢Ÿç©ºé–“
Get-WmiObject -Class Win32_LogicalDisk | Where-Object { $_.DeviceID -in @('E:', 'D:') } | Select-Object DeviceID, @{Name='FreeSpaceGB'; Expression={[math]::Round($_.FreeSpace / 1GB, 2)}}

# æ¸…ç†ç©ºé–“æˆ–ä¿®æ”¹ fasterq-dump åƒæ•¸
# ç·¨è¼¯ batch_fastq_downloader.py ç¬¬ 123 è¡Œï¼Œæ·»åŠ ï¼š
["run_id", "-O", str(output_dir), "--split-files", "--disk-limit", "500G"]
```

### â“ Q3: å¦‚ä½•è™•ç† "zombie file detected" éŒ¯èª¤ï¼Ÿ

**A**: 
é€™è¡¨ç¤º SRA æª”æ¡ˆæå£ï¼Œéœ€è¦é‡æ–°ä¸‹è¼‰ï¼š
```powershell
# åˆªé™¤æå£çš„æª”æ¡ˆ
Remove-Item -Recurse -Force "D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\SRR12180939"

# å¾ download_progress.json ç§»é™¤è©²æ¨£æœ¬
# é‡æ–°åŸ·è¡Œä¸‹è¼‰
python batch_fastq_downloader.py
```

### â“ Q4: ç¨‹å¼ä¸­æ–·å¾Œå¦‚ä½•ç¹¼çºŒï¼Ÿ

**A**:
ç›´æ¥é‡æ–°åŸ·è¡Œå³å¯ï¼Œç¨‹å¼æœƒè‡ªå‹•è·³éå·²å®Œæˆçš„æ¨£æœ¬ï¼š
```powershell
python batch_fastq_downloader.py
```

### â“ Q7: æŒ‰ Ctrl+C å¾Œç¨‹å¼æ²’æœ‰ç«‹å³åœæ­¢ï¼Ÿ

**A**:
é€™æ˜¯æ­£å¸¸è¡Œç‚ºï¼ç¨‹å¼ä½¿ç”¨å„ªé›…é€€å‡ºæ©Ÿåˆ¶ï¼š
- â¸ï¸ æœƒç­‰å¾…ç•¶å‰æ­£åœ¨åŸ·è¡Œçš„ä»»å‹™å®Œæˆï¼ˆæœ€å¤š 10 å€‹ä¸¦è¡Œä»»å‹™ï¼‰
- ğŸ’¾ ç¢ºä¿å·²å®Œæˆçš„ä»»å‹™æ­£ç¢ºä¿å­˜åˆ°é€²åº¦æª”æ¡ˆ
- ğŸš« ä¸æœƒå•Ÿå‹•æ–°çš„ä»»å‹™
- â±ï¸ é€šå¸¸åœ¨ 1-3 åˆ†é˜å…§å®Œå…¨åœæ­¢

**å¦‚æœéœ€è¦å¼·åˆ¶çµ‚æ­¢**:
```powershell
# æŸ¥æ‰¾ Python é€²ç¨‹
Get-Process python

# å¼·åˆ¶çµæŸ (å¯èƒ½å°è‡´é€²åº¦ä¸Ÿå¤±)
Stop-Process -Name python -Force
```

### â“ Q5: å¦‚ä½•åªä¸‹è¼‰ SRA ä¸è§£å£“ï¼Ÿ

**A**:
ä¿®æ”¹ `download_fastq()` å‡½æ•¸ï¼Œè¨»è§£æ‰æ­¥é©Ÿ 2-4ï¼š
```python
# è¨»è§£æ‰ç¬¬ 118-174 è¡Œ (fasterq-dumpã€å‚™ä»½ã€æ¸…ç†æ­¥é©Ÿ)
```

### â“ Q6: ä¸‹è¼‰éç¨‹ä¸­ OneDrive åŒæ­¥å¹²æ“¾

**A**:
```powershell
# æš«åœ OneDrive åŒæ­¥
# å³éµé»æ“Šç³»çµ±æ‰˜ç›¤çš„ OneDrive åœ–æ¨™ -> æš«åœåŒæ­¥ -> 24å°æ™‚

# æˆ–ä¿®æ”¹ç’°å¢ƒè®Šæ•¸
$env:NCBI_HOME = "D:\ncbi"
```

---

## 5. æ–‡ä»¶çµæ§‹

### ğŸ“‚ å®Œæ•´ç›®éŒ„æ¨¹

```
D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\
â”‚
â”œâ”€â”€ ğŸ“„ batch_fastq_downloader.py          # æ‰¹é‡ä¸‹è¼‰ä¸»ç¨‹å¼
â”œâ”€â”€ ğŸ“„ check_sra_integrity.py             # å®Œæ•´æ€§æª¢æŸ¥å·¥å…·
â”œâ”€â”€ ğŸ“„ runs.txt                            # 606 å€‹æ¨£æœ¬ ID åˆ—è¡¨
â”œâ”€â”€ ğŸ“„ download_progress.json              # ä¸‹è¼‰é€²åº¦è¿½è¹¤
â”œâ”€â”€ ğŸ“„ sra_integrity_report.json           # æª¢æŸ¥å ±å‘Š (åŸ·è¡Œæª¢æŸ¥å¾Œç”Ÿæˆ)
â”œâ”€â”€ ğŸ“„ SRAä¸‹è¼‰èˆ‡æª¢æŸ¥å·¥å…·ä½¿ç”¨æŒ‡å—.md        # æœ¬æ–‡æª”
â”‚
â”œâ”€â”€ ğŸ“ sratoolkit.3.2.1-win64\             # SRA Toolkit
â”‚   â””â”€â”€ ğŸ“ bin\
â”‚       â”œâ”€â”€ prefetch.exe                   # ä¸‹è¼‰å·¥å…·
â”‚       â”œâ”€â”€ fasterq-dump.exe               # è§£å£“å·¥å…·
â”‚       â”œâ”€â”€ vdb-validate.exe               # é©—è­‰å·¥å…·
â”‚       â””â”€â”€ sra-stat.exe                   # çµ±è¨ˆå·¥å…·
â”‚
â”œâ”€â”€ ğŸ“ SRR10810025\                        # è‡¨æ™‚ SRA ç›®éŒ„ (ä¸‹è¼‰ä¸­)
â”‚   â””â”€â”€ SRR10810025.sra
â”œâ”€â”€ ğŸ“ SRR10810029\
â”‚   â””â”€â”€ SRR10810029.sra
â””â”€â”€ ...

E:\fastq_data\                             # FASTQ è¼¸å‡º
â”œâ”€â”€ SRR10810025_1.fastq                    # æ­£å‘è®€å–
â”œâ”€â”€ SRR10810025_2.fastq                    # åå‘è®€å–
â””â”€â”€ ...

E:\sra_files\                              # SRA å‚™ä»½
â”œâ”€â”€ SRR10810025.sra
â””â”€â”€ ...
```

### ğŸ“‹ é—œéµæª”æ¡ˆèªªæ˜

| æª”æ¡ˆ | ç”¨é€” | ä½ç½® |
|------|------|------|
| `batch_fastq_downloader.py` | æ‰¹é‡ä¸‹è¼‰èˆ‡è§£å£“ | D æ§½ data_collector |
| `check_sra_integrity.py` | æª¢æŸ¥æª”æ¡ˆå®Œæ•´æ€§ | D æ§½ data_collector |
| `runs.txt` | æ¨£æœ¬ ID åˆ—è¡¨ (606 å€‹) | D æ§½ data_collector |
| `download_progress.json` | é€²åº¦è¿½è¹¤ | D æ§½ data_collector |
| `sra_integrity_report.json` | æª¢æŸ¥å ±å‘Š | D æ§½ data_collector |
| `*.sra` | SRA åŸå§‹æª”æ¡ˆ | E:\sra_files |
| `*.fastq` | FASTQ è§£å£“æª”æ¡ˆ | E:\fastq_data |

---

## ğŸ“ æŠ€è¡“æ”¯æ´

### ç›¸é—œè³‡æº

- **NCBI SRA Toolkit**: https://github.com/ncbi/sra-tools
- **SRA è³‡æ–™åº«**: https://www.ncbi.nlm.nih.gov/sra
- **fasterq-dump æ–‡æª”**: https://github.com/ncbi/sra-tools/wiki/HowTo:-fasterq-dump

### æ—¥èªŒä½ç½®

- ä¸‹è¼‰æ—¥èªŒ: çµ‚ç«¯è¼¸å‡º
- éŒ¯èª¤è¨˜éŒ„: `download_progress.json` çš„ `failed` é™£åˆ—
- æª¢æŸ¥å ±å‘Š: `sra_integrity_report.json`

---

## ğŸ“ æ›´æ–°æ—¥èªŒ

### 2025-10-07 v1.1
- âœ… ä¿®å¾©æš«åœåŠŸèƒ½ (åŠ å…¥ä¿¡è™Ÿè™•ç†å™¨)
- âœ… å„ªé›…é€€å‡ºæ©Ÿåˆ¶ (ç­‰å¾…ç•¶å‰ä»»å‹™å®Œæˆ)
- âœ… æ”¹é€²ä¸­æ–·æç¤ºè¨Šæ¯

### 2025-10-07 v1.0
- âœ… åŠ å…¥ä¸¦è¡Œä¸‹è¼‰åŠŸèƒ½ (MAX_WORKERS=10)
- âœ… å»ºç«‹å®Œæ•´æ€§æª¢æŸ¥å·¥å…·
- âœ… å„ªåŒ–é€²åº¦è¿½è¹¤æ©Ÿåˆ¶
- âœ… å¢åŠ å¯¦æ™‚ç§’æ•¸é¡¯ç¤º

### 2025-10-06
- âœ… å»¶é•·è¶…æ™‚è¨­å®š (120/150 åˆ†é˜)
- âœ… è§£æ±º disk-limit éŒ¯èª¤
- âœ… ä¿®å¾© lock file å•é¡Œ

### 2025-10-02
- âœ… åˆå§‹ç‰ˆæœ¬
- âœ… å››æ­¥é©Ÿè‡ªå‹•åŒ–æµç¨‹

---

**æ–‡æª”ç‰ˆæœ¬**: 1.1  
**æœ€å¾Œæ›´æ–°**: 2025-10-07  
**ä½œè€…**: GitHub Copilot  
**å°ˆæ¡ˆè·¯å¾‘**: `D:\OneDrive\å­¸æ ¡ä¸Šèª²\èª²ç¨‹\å››ä¸Š\ç§‘å­¸å¤§æ•¸æ“šå°ˆé¡Œ\data_collector\`

---

## ğŸ”§ æ•…éšœæ’é™¤

### ç¨‹å¼æ§åˆ¶å•é¡Œ

**å•é¡Œ**: æŒ‰ Ctrl+C å¾Œç­‰å¾…æ™‚é–“éé•·  
**åŸå› **: ä¸¦è¡Œä»»å‹™éœ€è¦å®Œæˆç•¶å‰æ­¥é©Ÿ  
**è§£æ±º**: è€å¿ƒç­‰å¾… 1-3 åˆ†é˜,æˆ–ä½¿ç”¨ `Stop-Process -Force` å¼·åˆ¶çµ‚æ­¢ (å¯èƒ½ä¸Ÿå¤±é€²åº¦)

**å•é¡Œ**: é‡æ–°å•Ÿå‹•å¾Œé‡è¤‡ä¸‹è¼‰å·²å®Œæˆçš„æ¨£æœ¬  
**åŸå› **: `download_progress.json` æœªæ­£ç¢ºä¿å­˜  
**è§£æ±º**: æª¢æŸ¥æª”æ¡ˆå®Œæ•´æ€§,å¿…è¦æ™‚æ‰‹å‹•ç·¨è¼¯

**å•é¡Œ**: ä¸¦è¡Œæ•¸é‡éé«˜å°è‡´ç³»çµ±å¡é “  
**åŸå› **: `MAX_WORKERS=10` ä½”ç”¨éå¤šç³»çµ±è³‡æº  
**è§£æ±º**: é™ä½è‡³ `MAX_WORKERS=5` æˆ– `MAX_WORKERS=3`
